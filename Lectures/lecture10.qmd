---
title: '<h1 style="font-size:3em; "> Multivariate regression </h1>'
title-slide-attributes:
  data-background-image: ../images/abstract_statistics_playful2.jpeg
  data-background-size: cover
  data-background-opacity: "0.33"
subtitle: "SOC 221 â€¢ Lecture 10"
author: "Victoria Sass"
date: "July 29, 2024"
date-format: full
execute: 
  echo: true
  message: false
  warning: false
format: 
  revealjs:
    reference-location: margin
    theme: lecture_styles.scss
    controls: true
    slide-number: true
    chalkboard: true
    incremental: false 
    smaller: true
    preview-links: true
    history: false
    progress: true
    link-external-icon: true 
    mermaid-format: svg
---

```{r}
#| echo: false
#| cache: false
require(tidyverse)
require(ggthemes)
require(gt)
require(gganimate)
require(ggforce)
require(DiagrammeR)
options(scipen = 1000)

knitr::opts_chunk$set(comment = ">")

# set transparent background in base
knitr::opts_chunk$set(dev.args=list(bg='transparent'))

# set transparent background in ggplot
ggplot2::theme_set(ggthemes::theme_tufte(base_size=12))
ggplot2::theme_update(panel.background = ggplot2::element_blank(),
                      plot.background=ggplot2::element_blank(),
    legend.background=ggplot2::element_blank())

options(width=80, show.signif.stars=FALSE)
```

# Multivariate regression {.section-title background-color="#c5b4e3"}

## Where ARE WE?

::: {.incremental style="font-size: 1.25em"}
* Bivariate correlation and regression good for detecting and describing basic associations between two variables (e.g., X and Y)
* Often want to bring in additional variables
    * [Build case for causality]{style="color: #e93cac"}
        * Control for alternative explanations for the main association
    * [Develop better predictions]{style="color: #e93cac"}
        * Predict Y as a function of multiple variables, not just X
    * [Explain more]{style="color: #e93cac"}
        * Use multiple variables to explain more of the variation in Y
* [**Multivariate regression**]{.underline}:  A key tool for bringing additional variables into consideration
:::

## Bivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b =$ slope of the line; <br> how much $Y$ changes with each one-unit difference in $X$
:::

<br>

::: {style="text-align: center; font-size: 2em;"}
$\color{#000000}{\widehat{y}} = \color{#000000}{a} + \color{#000000}{b}\color{#000000}{x}$
:::

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
<br>  
  
::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$
:::

## Bivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b =$ slope of the line; <br> how much $Y$ changes with each one-unit difference in $X$
:::

<br>

::: {style="text-align: center; font-size: 2em;"}
$\color{#a68100}{\widehat{y}} = \color{#000000}{a} + \color{#000000}{b}\color{#000000}{x}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
<br>  
  
::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$
:::

## Bivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b =$ slope of the line; <br> how much $Y$ changes with each one-unit difference in $X$
:::

<br>

::: {style="text-align: center; font-size: 2em;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#000000}{b}\color{#000000}{x}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
<br>  
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$
:::

## Bivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

<br>

::: {style="color: #e93cac; text-align: center; font-size: 1.25em"}
$b =$ slope of the line; <br> how much $Y$ changes with each one-unit difference in $X$
:::

<br>

::: {style="text-align: center; font-size: 2em;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#e93cac}{b}\color{#000000}{x}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
<br>  
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$
:::

## Bivariate regression

<br>

::: {style="color: #1b8883; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

<br>

::: {style="color: #e93cac; text-align: center; font-size: 1.25em"}
$b =$ slope of the line; <br> how much $Y$ changes with each one-unit difference in $X$
:::

<br>

::: {style="text-align: center; font-size: 2em;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#e93cac}{b}\color{#1b8883}{x}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
<br>  
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$
:::

## Multivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#000000}{\widehat{y}} = \color{#000000}{a} + \color{#000000}{b_1}\color{#000000}{x} + \color{#000000}{b_2}\color{#000000}{z}$
:::

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$ and $Z = 0$
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$z$ is the value of $Z$ for the individual
:::

## Multivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#a68100}{\widehat{y}} = \color{#000000}{a} + \color{#000000}{b_1}\color{#000000}{x} + \color{#000000}{b_2}\color{#000000}{z}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$ and $Z = 0$
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$z$ is the value of $Z$ for the individual
:::

## Multivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#000000}{b_1}\color{#000000}{x} + \color{#000000}{b_2}\color{#000000}{z}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$ and $Z = 0$
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$z$ is the value of $Z$ for the individual
:::

## Multivariate regression

<br>

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e93cac; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#e93cac}{b_1}\color{#000000}{x} + \color{#000000}{b_2}\color{#000000}{z}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$ and $Z = 0$
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$z$ is the value of $Z$ for the individual
:::

## Multivariate regression

<br>

::: {style="color: #1b8883; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e93cac; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#e93cac}{b_1}\color{#1b8883}{x} + \color{#000000}{b_2}\color{#000000}{z}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$ and $Z = 0$
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$z$ is the value of $Z$ for the individual
:::

## Multivariate regression

<br>

::: {style="color: #1b8883; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e93cac; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {style="color: #690c48; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#e93cac}{b_1}\color{#1b8883}{x} + \color{#690c48}{b_2}\color{#000000}{z}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$ and $Z = 0$
:::

::: {style="color: #e8e3d3; text-align: center; font-size: 1.25em"}
$z$ is the value of $Z$ for the individual
:::

## Multivariate regression

<br>

::: {style="color: #1b8883; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e93cac; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {style="color: #690c48; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#e93cac}{b_1}\color{#1b8883}{x} + \color{#690c48}{b_2}\color{#6e8e13}{z}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X = 0$ and $Z = 0$
:::

::: {style="color: #6e8e13; text-align: center; font-size: 1.25em"}
$z$ is the value of $Z$ for the individual
:::

::: {.fragment fragment-index=1 style="background: #e93cac; border: 4px solid #690c48; border-radius: 15px; width: 300px; padding: 5px 5px 5px 5px; position: absolute; top: -25px; right: -75px; text-align: center"}
When we [*control for*]{.underline} a variable, we are holding its effect constant (i.e., removing its influence)
:::

::: {.fragment fragment-index=2 style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; width: 360px; padding: 5px 5px 5px 5px; position: absolute; top: 285px; left: -75px; text-align: center"}
Note that we are [**ADDING**]{style="color: #6e8e13"}  variables to the model in order to **REMOVE** their [influence]{style="color: #690c48"} from the [*effects*]{style="color: #e93cac"} of $X$.
:::

::: {.fragment fragment-index=3 style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; width: 300px; padding: 5px 5px 5px 5px; position: absolute; top: 300px; right: -25px; text-align: center"}
 When they are not in the model, we are [ignoring]{.underline} their [influence]{style="color: #690c48"}
:::


## Multivariate regression

::: {style="color: #1b8883; text-align: center; font-size: 1.25em"}
$x$ is the value of $X$ for the individual
:::

::: {style="color: #e93cac; text-align: center; font-size: 1.25em"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z_1$ and $Z_k$**
:::

::: {style="color: #690c48; text-align: center; font-size: 1.25em"}
$b_2 =$ the effect of $Z_1$ on $Y$ **after controlling for the effects of $X$ and $Z_k$**
:::

::: {style="color: #bf5700; text-align: center; font-size: 1.25em"}
$b_k =$ the effect of $Z_k$ on $Y$ **after controlling for the effects of $X$ and $Z_1$**
:::

<br>

::: {style="font-size: 2em; text-align: center;"}
$\color{#a68100}{\widehat{y}} = \color{#754cbc}{a} + \color{#e93cac}{b_1}\color{#1b8883}{x} + \color{#690c48}{b_2}\color{#6e8e13}{z} + \text{. . . } + \color{#bf5700}{b_k}\color{#808080}{z_k}$
:::

<br>

::: {style="color: #a68100; text-align: center; font-size: 1.25em"}
$\widehat{y}$ is the predicted value of $Y$
:::
  
::: {style="color: #754cbc; text-align: center; font-size: 1.25em"}
$a = Y-intercept$ (i.e., *constant*); <br>
predicted value of $Y$ when $X$, $Z_1$, and $Z_k$ all equal $0$
:::

::: {style="color: #6e8e13; text-align: center; font-size: 1.25em"}
$z_1$ is the value of $Z_1$ for the individual
:::

::: {style="color: #808080; text-align: center; font-size: 1.25em"}
$z_k$ is the value of $Z_k$ for the individual
:::

## Why multivariate regression?

<br>

::: {style="font-size: 1.75em;"}
* [Purpose 1: building the case for causality]{style="color: #e93cac"}
    * [Control for alternate explanations for the main association]{style="font-size: 0.75em"}
* [Purpose 2: developing better predictions]{.fragment .semi-fade-out fragment-index=1 style="color: #e93cac"}
    * [Predict $Y$ as a function of multiple variables, not just $X$]{.fragment .semi-fade-out fragment-index=1 style="font-size: 0.75em"}
* [Purpose 3: explain more]{.fragment .semi-fade-out fragment-index=1 style="color: #e93cac"}
    * [Use multiple variables to explain more of the variation in $Y$]{.fragment .semi-fade-out fragment-index=1 style="font-size: 0.75em"}
:::

## Purpose 1: building the case for causality

<br>

::: {.fragment style="font-size: 2em;  position: absolute; left: -25px; top: 100px"}
> [**Causality**]{style="color: #e93cac"}: <br> 
A situation in which <br> 
one condition, event, <br> 
or process contributes <br> 
to the production of <br> 
another condition, event, <br> 
process, or state
:::

::: {.fragment style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> # stylize so visible with background color (code below was excruciating attempt to color all table lines darker but I couldn't figure out how to change all lines)
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {.fragment style="position: absolute; bottom: 200px; right: 25px"}
Is there an association between <br>
ice cream sales and crime?
:::

## Purpose 1: building the case for causality

<br>

::: {style="font-size: 2em; position: absolute; left: -25px; top: 100px"}
> [**Causality**]{style="color: #e93cac"}: <br> 
A situation in which <br> 
one condition, event, <br> 
or process contributes <br> 
to the production of <br> 
another condition, event, <br> 
process, or state
:::

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 200px; right: 25px"}
Is there an association between <br>
ice cream sales and crime?
:::

::: {style="position: absolute; bottom: 0px; right: -50px; text-align: center; color: #754cbc; width: 550px; font-size: 1.25em"}
**Yes!** Differences in conditional distributions (column $\%$s) show a positive association between ice cream sales and crime.
:::

## Purpose 1: building the case for causality

<br>

::: {style="font-size: 2em; position: absolute; left: -25px; top: 100px"}
> [**Causality**]{style="color: #e93cac"}: <br> 
A situation in which <br> 
one condition, event, <br> 
or process contributes <br> 
to the production of <br> 
another condition, event, <br> 
process, or state
:::

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 225px; right: 25px; width: 350px"}
Does this mean that ice cream sales *cause* crime to increase?
:::

::: {style="position: absolute; bottom: -35px; right: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

icecream_crime <- create_graph() |> 
  add_node(label = "Violent\ncrime", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "Ice cream\nsales", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |> 
  add_edge(from = 2, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 0.75)) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")
icecream_crime
```
:::

## Purpose 1: building the case for causality

<br>

::: {.incremental style="font-size: 1.25em; position: absolute; left: -25px; top: 100px; width: 600px"}
[3 Criteria for Causality]{.center .underline}
[*(what we need to show to claim that $X$ causes $Y$)*]{.center style="font-size: 0.75em;"} <br>

1. There is a statistical association between $X$ and $Y$
2. $X$ happens before $Y$ 
    * (correct time ordering)
3. No other variable accounts for the statistical link between $X$ and $Y$
:::

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 225px; right: 25px; width: 350px"}
Does this mean that ice cream sales *cause* crime to increase?
:::

::: {style="position: absolute; bottom: -35px; right: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

icecream_crime
```
:::

## Purpose 1: building the case for causality

<br>

::: {style="font-size: 1.25em; position: absolute; left: -25px; top: 100px; width: 600px"}
[3 Criteria for Causality]{.center .underline}
[*(what we need to show to claim that $X$ causes $Y$)*]{.center style="font-size: 0.75em;"} <br>

1. There is a statistical association between $X$ and $Y$
2. $X$ happens before $Y$ 
    * (correct time ordering)
3. [No other variable accounts for the statistical link between $X$ and $Y$]{style="color: #e93cac"}
:::

::: {style="background: #e93cac; border: 4px solid #690c48; border-radius: 15px; width: 650px; padding: 5px 5px 5px 5px; position: absolute; bottom: 25px; left: -75px; text-align: center; font-size: 0.95em"}
Third criterion motivates us to control for other variables <br>
(i.e., account for their effects; remove their influence)

:::

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 225px; right: 25px; width: 350px"}
Does this mean that ice cream sales *cause* crime to increase?
:::

::: {style="position: absolute; bottom: -35px; right: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

icecream_crime
```
:::

## Purpose 1: building the case for causality

<br>

::: {style="font-size: 1.25em; position: absolute; left: -25px; top: 100px; width: 600px"}
[3 Criteria for Causality]{.center .underline}
[*(what we need to show to claim that $X$ causes $Y$)*]{.center style="font-size: 0.75em;"} <br>

1. There is a statistical association between $X$ and $Y$
2. $X$ happens before $Y$ 
    * (correct time ordering)
3. [No other variable accounts for the statistical link between $X$ and $Y$]{style="color: #e93cac"}
:::

::: {style="background: #e93cac; border: 4px solid #690c48; border-radius: 15px; width: 650px; padding: 5px 5px 5px 5px; position: absolute; bottom: 25px; left: -75px; text-align: center; font-size: 0.95em"}
Third criterion motivates us to control for other variables <br>
(i.e., account for their effects; remove their influence)
:::

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 225px; right: 25px; width: 350px"}
Does this mean that ice cream sales *cause* crime to increase?
:::

::: {style="position: absolute; bottom: -35px; right: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

icecream_crime
```
:::

::: {style="position: absolute; bottom: -15px; right: 25px; width: 350px; background: #ffc700; border: 4px solid #a68100; border-radius: 15px; width: 360px; padding: 5px 5px 5px 5px;"}
Or is the association spurious?
:::

## Purpose 1: building the case for causality

<br>

::: {style="font-size: 2em; position: absolute; left: -25px; top: 100px"}
> [**Spurious relationship**]{style="color: #e93cac"}: <br> 
A situation in which <br> 
two variables are <br> 
**statistically associated** <br>
but [not causally related]{.underline}, <br>
due to their coincidence <br>
of a certain third, <br> 
unseen factor.
:::

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 225px; right: 25px; width: 350px"}
Does this mean that ice cream sales *cause* crime to increase?
:::

::: {style="position: absolute; bottom: -35px; right: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

icecream_crime
```
:::

::: {style="position: absolute; bottom: -15px; right: 25px; width: 350px; background: #ffc700; border: 4px solid #a68100; border-radius: 15px; width: 360px; padding: 5px 5px 5px 5px;"}
Or is the association [spurious]{style="color: #e93cac"}?
:::

## Purpose 1: building the case for causality

<br>

::: {style="font-size: 2em; position: absolute; left: -25px; top: 100px"}
> [**Spurious relationship**]{style="color: #e93cac"}: <br> 
A situation in which <br> 
two variables are <br> 
**statistically associated** <br>
but [not causally related]{.underline}, <br>
due to their coincidence <br>
of a certain third, <br> 
unseen factor.
:::

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 25px; right: -75px; width: 500px; background: #e93cac; border: 4px solid #690c48; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center; font-size: 1.25em"}
Certain values on one variable ($Y$) tend to correspond with certain values on the other ($X$) because both are affected by a [**third**]{.underline} outside variable.
:::

## Purpose 1: building the case for causality

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 25px; right: -75px; width: 500px; background: #e93cac; border: 4px solid #690c48; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center; font-size: 1.25em"}
Certain values on one variable ($Y$) tend to correspond with certain values on the other ($X$) because both are affected by a [**third**]{.underline} outside variable.
:::

::: {style="position: absolute; top: 50px; left: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

create_graph() |> 
  add_node(label = "???", 
           node_aes = node_aes(shape = "rectangle", fillcolor = "#2ad2c9", color = "#1b8883", fontcolor = "black", width = 0.7, height = 0.3)) |> 
  add_node(label = "Ice cream\nsales", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |> 
  add_node(label = "Violent\ncrime", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |> 
  add_edge(from = 1, to = 3, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 0.75)) |> 
  add_edge(from = 1, to = 2, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 0.75)) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "tree")
```
:::

## Purpose 1: building the case for causality

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 25px; right: -75px; width: 500px; background: #e93cac; border: 4px solid #690c48; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center; font-size: 1.25em"}
Certain values on one variable ($Y$) tend to correspond with certain values on the other ($X$) because both are affected by a [**third**]{.underline} outside variable.
:::

::: {style="position: absolute; top: 50px; left: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

weather <- create_graph() |> 
  add_node(label = "Weather", 
           node_aes = node_aes(shape = "rectangle", fillcolor = "#2ad2c9", color = "#1b8883", fontcolor = "black", width = 0.7, height = 0.3)) |> 
  add_node(label = "Ice cream\nsales", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |> 
  add_node(label = "Violent\ncrime", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |> 
  add_edge(from = 1, to = 3, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 0.75)) |> 
  add_edge(from = 1, to = 2, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 0.75)) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "tree")
weather
```
:::

::: {.fragment style="background: #2ad2c9; border: 4px solid #1b8883; border-radius: 15px; width: 450px; padding: 5px 5px 5px 5px; position: absolute; bottom: 50px; left: 0px; text-align: center"}
**Note**: Weather might create a link between ice cream sales and crime. [Failing to control for weather might make the association look causal even though that is false.]{.underline} 
:::

## Purpose 1: building the case for causality

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

crime_icecream <- data.frame(low_ice_cream = c("20 <br> (83.3%)", "4 <br> (16.7%)",  "24"), high_ice_cream = c("4 <br> (33.3%)", "8 <br> (66.7%)", "12"), Total = c("24 <br> (66.7%)", "12 <br> (33.3%)", "36"))
rownames(crime_icecream) <- c("Low violent crime", "High violent crime", "Total")

crime_icecream |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (all months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "gray", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "#c5b4e3"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="position: absolute; bottom: 75px; right: -25px; width: 400px; background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
To control for weather, we look at the association between ice cream sales and crime among cases (months) with [similar weather]{.underline}. 
:::

::: {style="position: absolute; top: 50px; left: 25px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

weather
```
:::

::: {.fragment style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; width: 500px; padding: 5px 5px 5px 5px; position: absolute; bottom: 75px; left: 0px; text-align: center"}
Any association between ice cream sales and crime among cases (months) with similar weather cannot be attributed to the effects of differences in weather. 
:::

## Purpose 1: building the case for causality

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

warm <- data.frame(low_ice_cream = c("0 <br> (0.0%)", "3 <br> (100.0%)",  "3"), high_ice_cream = c("0 <br> (0.0%)", "8 <br> (100.0%)", "8"), Total = c("0 <br> (0.0%)", "11 <br> (100.0%)", "11"))
rownames(warm) <- c("Low violent crime", "High violent crime", "Total")

warm |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (WARM months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "red", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "rosybrown1"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="font-size: 1.25em; position: absolute; left: 0px; top: 100px; width: 500px; text-align: center"}
**Is there an association between ice cream sales and crime?**
:::

::: {.fragment style="font-size: 1em; position: absolute; left: 0px; top: 225px; width: 500px; color: #e93cac; text-align: center; border: 4px solid #690c48; border-radius: 15px; padding: 5px 5px 5px 5px;"}
*No differences in conditional distributions (column %s), indicating that there is no association between ice cream sales and crime among warm months.*
:::

::: {style="position: absolute; bottom: 75px; right: -25px; width: 400px; background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
To control for weather, we look at the association between ice cream sales and crime among cases (months) with [similar weather]{.underline}. 
:::

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; width: 500px; padding: 5px 5px 5px 5px; position: absolute; bottom: 75px; left: 0px; text-align: center"}
Any association between ice cream sales and crime among cases (months) with similar weather cannot be attributed to the effects of differences in weather. 
:::

## Purpose 1: building the case for causality

::: {style="position: absolute; top: 75px; right: -150px"}
```{r}
#| echo: false

cool <- data.frame(low_ice_cream = c("20 <br> (95.2%)", "1 <br> (4.8%)",  "21"), high_ice_cream = c("4 <br> (100.0%)", "0 <br> (0.0%)", "4"), Total = c("24 <br> (96.0%)", "1 <br> (4.0%)", "25"))
rownames(cool) <- c("Low violent crime", "High violent crime", "Total")

cool |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = "Bivariate table (COOL months):", subtitle = "Violent crime by ice cream sales") |> # add title and subtitle
  fmt_markdown(columns = everything()) |> # include html 
  cols_align(align = "center", columns = everything()) |> # center columns
  cols_label(low_ice_cream = "Low ice cream sales", high_ice_cream = "High ice cream sales") |> 
  opt_stylize(style = 5, color = "blue", add_row_striping = TRUE) |> 
  tab_style(style = cell_fill(color = "lightblue1"), 
            locations = cells_body(rows = c("Low violent crime", "High violent crime"),
                                   columns = c(low_ice_cream, high_ice_cream))) |> 
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(65), table.font.size = px(18L)) 
```
:::

::: {style="font-size: 1.25em; position: absolute; left: 0px; top: 100px; width: 500px; text-align: center"}
**Is there an association between ice cream sales and crime?**
:::

::: {style="font-size: 1em; position: absolute; left: 0px; top: 225px; width: 525px; color: steelblue; text-align: center; border: 4px solid darkblue; border-radius: 15px; padding: 5px 5px 5px 5px;"}
*Little differences in conditional distributions (column %s), indicating that there is little association between ice cream sales and crime among cool months.*
:::

::: {style="position: absolute; bottom: 75px; right: -25px; width: 400px; background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
To control for weather, we look at the association between ice cream sales and crime among cases (months) with [similar weather]{.underline}. 
:::

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; width: 500px; padding: 5px 5px 5px 5px; position: absolute; bottom: 75px; left: 0px; text-align: center"}
Any association between ice cream sales and crime among cases (months) with similar weather cannot be attributed to the effects of differences in weather. 
:::

## Purpose 1: building the case for causality

### Summary of logic

::: {.incremental style="font-size: 1.25em"}
* To build the case that $X$ [causes]{.underline} $Y$, we have to show that no other variable accounts for the statistical association between $X$ and $Y$ (association is not spurious)
* We need to see if the association between $X$ and $Y$ persists even after we [control]{.underline} (remove the influence of) other explanatory variables (for example, $Z$)
* If the association between $X$ and $Y$ goes way when we control for $Z$ then the association was probably spurious (i.e., false)
* The part of the association between $X$ and $Y$ that remains after we control for $Z$ MIGHT represent the causal effect of $X$ on $Y$ (but still other potential explanations)
:::

## Purpose 1: building the case for causality

:::: {.columns}

::: {.column width="50%"}

::: {.fragment fragment-index=2 style="background: #e93cac; border: 4px solid #690c48; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
$b_1$ and $b_2$ are called [**PARTIAL SLOPES**]{.underline}
:::

<br>

::: {.fragment fragment-index=2 style="font-size: 1.5em"}
> [**PARTIAL SLOPES**]{style="color: #e93cac"}: <br>
Slope coefficient from a multivariate regression model, representing the effects of one predictor on the dependent variable while controlling for all other predictors in the model. 
:::


:::
  
::: {.column width="50%"}

<br>

::: {style="text-align: center; font-size: 1.15em"}
Multivariate regression is a convenient tool for assessing the association between two variables ($X \text{ and } Y$) while controlling for others ($Z$)) 
:::

<br>

::: {.fragment fragment-index=1 style="font-size: 2em; text-align: center;"}
$\color{#000000}{\widehat{y}} = \color{#000000}{a} + \color{#e93cac}{b_1}\color{#000000}{x} + \color{#690c48}{b_2}\color{#000000}{z}$
:::

<br>

::: {.fragment fragment-index=1 style="color: #e93cac; text-align: center; font-size: 1.25em;"}
$b_1 =$ the effect of $X$ on $Y$ **after controlling for the effects of $Z$**
:::

::: {.fragment fragment-index=1 style="color: #690c48; text-align: center; font-size: 1.25em;"}
$b_2 =$ the effect of $Z$ on $Y$ **after controlling for the effects of $X$**
:::

:::
  
::::

## Purpose 1: building the case for causality

::: {style="background: #c5b4e3; border: 4px solid #754cbc; border-radius: 15px; padding: 5px 5px 5px 5px; font-size: 1.5em; width: 700px"}
**BIVARIATE SLOPE:** [*Association between $X$ and $Y$*]{style="font-size: 0.66em;"}
:::

::: {style="font-size: 2em"}
$$
b = r_{yx}(\frac{s_y}{s_x})
$$
:::

::: {style="background: #c5b4e3; border: 4px solid #754cbc; border-radius: 15px;padding: 5px 5px 5px 5px; font-size: 1.5em; width: 900px"}
**PARTIAL SLOPE:** [*Association between $X$ and $Y$ after controlling for $Z$*]{style="font-size: 0.66em;"}
:::

::: {style="font-size: 2em"}
$$
b_1 = (\frac{r_{yx}-r_{yz}r_{xz}}{1-r^2_{xz}})(\frac{s_y}{s_x})
$$
:::

::: {.fragment fragment-index=1 style="position: absolute; top: 29px; right: -75px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

create_graph() |> 
  add_node(label = "Violent\ncrime (Y)", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "Weather (Z)", 
           node_aes = node_aes(shape = "rectangle", fillcolor = "#2ad2c9", color = "#1b8883", fontcolor = "black", width = 0.8, height = 0.3)) |>
  add_node(label = "Ice cream\nsales (X)", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_edge(from = 2, to = 1,
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 2, to = 3, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 3, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#4b2e83", penwidth = 1.5, style = "dashed")) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")

```
:::

::: {.fragment fragment-index=2 style="color: #85754d; position: absolute; top: 150px; right: 175px;"}
$r_{xz}$
:::

::: {.fragment fragment-index=2 style="color: #85754d; position: absolute; top: 150px; right: 22px;"}
$r_{yz}$
:::

::: {.fragment fragment-index=2 style="color: #4b2e83; position: absolute; top: 260px; right: 110px;"}
$r_{yx}$
:::

## Purpose 1: building the case for causality

::: {style="background: #c5b4e3; border: 4px solid #754cbc; border-radius: 15px; padding: 5px 5px 5px 5px; font-size: 1.5em; width: 700px"}
**BIVARIATE SLOPE:** [*Association between $X$ and $Y$*]{style="font-size: 0.66em;"}
:::

::: {style="font-size: 2em"}
$$
b = r_{yx}(\frac{s_y}{s_x})
$$
:::

::: {style="background: #c5b4e3; border: 4px solid #754cbc; border-radius: 15px;padding: 5px 5px 5px 5px; font-size: 1.5em; width: 900px"}
**PARTIAL SLOPE:** [*Association between $X$ and $Y$ after controlling for $Z$*]{style="font-size: 0.66em;"}
:::

::: {style="font-size: 2em"}
$$
b_1 = (\frac{\color{#4b2e83}{r_{yx}}-\color{#85754d}{r_{yz}r_{xz}}}{1-r^2_{xz}})(\frac{s_y}{s_x})
$$
:::

::: {style="color: #4b2e83; border: 4px solid #4b2e83; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; bottom: 75px; left: -60px; text-align: center"}
Looking at the correlation<br>between $X$ and $Y$...
:::

::: {.fragment style="color: #85754d; border: 3px solid #85754d; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; bottom: 50px; right: -75px; text-align: center"}
... and subtracting out <br>
the common connection of <br>
these variables to Z
:::



::: {style="position: absolute; top: 29px; right: -75px;"}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4

create_graph() |> 
  add_node(label = "Violent\ncrime (Y)", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "Weather (Z)", 
           node_aes = node_aes(shape = "rectangle", fillcolor = "#2ad2c9", color = "#1b8883", fontcolor = "black", width = 0.8, height = 0.3)) |>
  add_node(label = "Ice cream\nsales (X)", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_edge(from = 2, to = 1,
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 2, to = 3, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 3, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#4b2e83", penwidth = 1.5, style = "dashed")) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")

```
:::

::: {style="color: #85754d; position: absolute; top: 150px; right: 175px;"}
$r_{xz}$
:::

::: {style="color: #85754d; position: absolute; top: 150px; right: 22px;"}
$r_{yz}$
:::

::: {style="color: #4b2e83; position: absolute; top: 260px; right: 110px;"}
$r_{yx}$
:::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {.fragment fragment-index=1 style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

::: {.fragment fragment-index=2 style="color: #1b8883; position: absolute; right: 50px; top: 110px; border: 3px solid #1b8883; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
[ASSOCIATION]{.underline}: <br> Each additional year of education <br> is associated with $1,582.58 <br> in additional income
:::

:::: {.columns}

::: {.column width="50%"}

<br>

::: {.fragment fragment-index=3 style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
Does this mean that education causes income to increase?
:::


::: {.fragment fragment-index=3}
```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4
#| fig-align: center

educ_income <- create_graph() |> 
  add_node(label = "Income", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "Education", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |> 
  add_edge(from = 2, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 0.75)) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")
educ_income
```
:::

:::
  
::: {.column width="50%"}

<br>

::: {.fragment fragment-index=4 style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
Or is the association at least partly spurious? 
:::

::: {.fragment fragment-index=4}
```{r}
#| echo: false
#| fig-width: 3.5
#| fig-height: 3.5
#| fig-align: center

create_graph() |> 
  add_node(label = "Income", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "???", 
           node_aes = node_aes(shape = "rectangle", fillcolor = "#2ad2c9", color = "#1b8883", fontcolor = "black", width = 1.25, height = 0.3)) |>
  add_node(label = "Education", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_edge(from = 2, to = 1,
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 2, to = 3, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 3, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#4b2e83", penwidth = 1.5, style = "dashed")) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")
```
:::

:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

::: {style="color: #1b8883; position: absolute; right: 50px; top: 110px; border: 3px solid #1b8883; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
[ASSOCIATION]{.underline}: <br> Each additional year of education <br> is associated with $1,582.58 <br> in additional income
:::

:::: {.columns}

::: {.column width="50%"}

<br>

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
Does this mean that education causes income to increase?
:::

```{r}
#| echo: false
#| fig-width: 4
#| fig-height: 4
#| fig-align: center

educ_income <- create_graph() |> 
  add_node(label = "Income", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "Education", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |> 
  add_edge(from = 2, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 0.75)) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")
educ_income
```

:::
  
::: {.column width="50%"}

<br>

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
Or is the association at least partly spurious? 
:::


```{r}
#| echo: false
#| fig-width: 3.5
#| fig-height: 3.5
#| fig-align: center

create_graph() |> 
  add_node(label = "Income", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "Parental Wealth", 
           node_aes = node_aes(shape = "rectangle", fillcolor = "#2ad2c9", color = "#1b8883", fontcolor = "black", width = 1.25, height = 0.3)) |>
  add_node(label = "Education", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_edge(from = 2, to = 1,
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 2, to = 3, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 3, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#4b2e83", penwidth = 1.5, style = "dashed")) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")
```


:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

::: {style="position: absolute; right: 125px; top: 110px; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center; font-size: 1.5em"}
$$
b = r_{yx}(\frac{s_y}{s_x})
$$
:::

:::: {.columns}

::: {.column width="50%"}

<br>
<br>

::: {style="text-align: center"}
Look at the association <br> between [**education and income**]{.underline style="color: #4b2e83"}, <br> subtracting out their <br> [**common connection to parental wealth**]{.underline style="color: #85754d"}
:::

<br>

::: {style="font-size: 1.5em"}
$$
b_1 = (\frac{\color{#4b2e83}{r_{yx}}-\color{#85754d}{r_{yz}r_{xz}}}{1-r^2_{xz}})(\frac{s_y}{s_x})
$$
:::

:::
  
::: {.column width="50%"}

<br>

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
Or is the association at least partly spurious? 
:::


```{r}
#| echo: false
#| fig-width: 3.5
#| fig-height: 3.5
#| fig-align: center

create_graph() |> 
  add_node(label = "Income\n(Y)", 
           node_aes = node_aes(shape = "circle", fillcolor = "#808080", color = "#808080", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_node(label = "Parental Wealth (Z)", 
           node_aes = node_aes(shape = "rectangle", fillcolor = "#2ad2c9", color = "#1b8883", fontcolor = "black", width = 1.25, height = 0.3)) |>
  add_node(label = "Education\n(X)", 
           node_aes = node_aes(shape = "circle", fillcolor = "black", color = "black", fontcolor = "white", width = 0.8, height = 0.3)) |>
  add_edge(from = 2, to = 1,
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 2, to = 3, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#85754d", penwidth = 1.5)) |> 
  add_edge(from = 3, to = 1, 
           edge_aes = edge_aes(arrowhead = "normal", arrowsize = 0.9, color = "#4b2e83", penwidth = 1.5, style = "dashed")) |> 
  add_global_graph_attrs(attr = "bgcolor", value = "#e8e3d3", attr_type = "graph") |> 
  render_graph(as_svg = TRUE, layout = "kk")
```


:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

::: {.fragment style="color: #1b8883; position: absolute; right: 50px; top: 110px; border: 3px solid #1b8883; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
[ASSOCIATION]{.underline}: <br> Each additional year of education <br> is associated with $1,582.58 <br> in additional income
:::

<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = 799.22 + 623.35(educ) + 0.31(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

:::

::: {.column width="33.33%"}


:::
  
::: {.column width="33.33%"}

:::
  
::::


## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

::: {style="color: #1b8883; position: absolute; right: 50px; top: 110px; border: 3px solid #1b8883; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
[ASSOCIATION]{.underline}: <br> Each additional year of education <br> is associated with $1,582.58 <br> in additional income
:::

<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = 799.22 + \color{#6e8e13}{623.35}(educ) + 0.31(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

:::

::: {.column width="33.33%"}

::: {style="text-align: center; color: #6e8e13; font-size: 1.25em"}
**$b_1$**: Controlling for parental wealth, each additional year of education is associated with $\$623.35$ in additional income
:::
:::
  
::: {.column width="33.33%"}

:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

::: {style="color: #1b8883; position: absolute; right: 50px; top: 110px; border: 3px solid #1b8883; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
[ASSOCIATION]{.underline}: <br> Each additional year of education <br> is associated with $1,582.58 <br> in additional income
:::

<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = 799.22 + \color{#6e8e13}{623.35}(educ) + \color{#754cbc}{0.31}(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

:::

::: {.column width="33.33%"}

::: {style="text-align: center; color: #6e8e13; font-size: 1.25em"}
**$b_1$**: Controlling for parental wealth, each additional year of education is associated with $\$623.35$ in additional income
:::
:::
  
::: {.column width="33.33%"}
::: {style="text-align: center; color: #754cbc; font-size: 1.25em"}
**$b_2$**: Controlling for education, each additional dollar of parental wealth is associated with $\$0.31$ in additional income

:::
:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

::: {style="color: #1b8883; position: absolute; right: 50px; top: 110px; border: 3px solid #1b8883; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center"}
[ASSOCIATION]{.underline}: <br> Each additional year of education <br> is associated with $1,582.58 <br> in additional income
:::

<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = \color{#a68100}{799.22} + \color{#6e8e13}{623.35}(educ) + \color{#754cbc}{0.31}(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

::: {style="text-align: center; color: #a68100; font-size: 1.25em"}
**$a$**: A person with 0 years of education and 0 dollars of parental wealth is predicted to have an income $\$799.22$
:::

:::

::: {.column width="33.33%"}

::: {style="text-align: center; color: #6e8e13; font-size: 1.25em"}
**$b_1$**: Controlling for parental wealth, each additional year of education is associated with $\$623.35$ in additional income
:::
:::
  
::: {.column width="33.33%"}
::: {style="text-align: center; color: #754cbc; font-size: 1.25em"}
**$b_2$**: Controlling for education, each additional dollar of parental wealth is associated with $\$0.31$ in additional income

:::
:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + \color{#6e8e13}{1582.58}(educ)$
:::



<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = 799.22 + \color{#6e8e13}{623.35}(educ) + 0.31(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

::: {style="text-align: center; color: #6e8e13; font-size: 1.25em"}
Apparent association between education and income is reduced after controlling for parental wealth.
:::

:::

::: {.column width="33.33%"}



:::
  
::: {.column width="33.33%"}

:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + \color{#6e8e13}{1582.58}(educ)$
:::



<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = 799.22 + \color{#6e8e13}{623.35}(educ) + 0.31(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

::: {style="text-align: center; color: #6e8e13; font-size: 1.25em"}
Apparent association between education and income is reduced after controlling for parental wealth.
:::

:::

::: {.column width="33.33%"}

::: {style="text-align: center; color: #080808; font-size: 1.25em"}
The association between education and income appears to be at least PARTIALLY spurious.
:::

:::
  
::: {.column width="33.33%"}

:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + \color{#6e8e13}{1582.58}(educ)$
:::



<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = 799.22 + \color{#6e8e13}{623.35}(educ) + \color{#754cbc}{0.31}(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

::: {style="text-align: center; color: #6e8e13; font-size: 1.25em"}
Apparent association between education and income is reduced after controlling for parental wealth.
:::

:::

::: {.column width="33.33%"}

::: {style="text-align: center; color: #080808; font-size: 1.25em"}
The association between education and income appears to be at least PARTIALLY spurious.
:::

:::
  
::: {.column width="33.33%"}
::: {style="text-align: center; color: #754cbc; font-size: 1.25em"}
Part of the basic association between education and income is due to the fact that they are both affected by parental wealth.
:::
:::
  
::::

## Purpose 1: building the case for causality

#### [Another example]{style="color: #e93cac"}: Does education have a *causal* effect on income?

::: {style="font-size:1.5em"}
[**Bivariate regression model**]{style="color: #1b8883"} <br>
$\widehat{Income} = 1816.16 + \color{#6e8e13}{1582.58}(educ)$
:::

::: {style="color: black; position: absolute; right: 50px; top: 150px; border: 3px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; text-align: center; width: 350px"}
Next step: Add other controls that might account for the remaining association.
::: 

<br>

::: {style="font-size:1.5em"}
[**Multivariate regression model**]{style="color: #e93cac"} <br>
$\widehat{Income} = 799.22 + \color{#6e8e13}{623.35}(educ) + \color{#754cbc}{0.31}(\text{par_wealth})$
:::

:::: {.columns}

::: {.column width="33.33%"}

::: {style="text-align: center; color: #6e8e13; font-size: 1.25em"}
Apparent association between education and income is reduced after controlling for parental wealth.
:::

:::

::: {.column width="33.33%"}

::: {style="text-align: center; color: #080808; font-size: 1.25em"}
The association between education and income appears to be at least PARTIALLY spurious.
:::

:::
  
::: {.column width="33.33%"}
::: {style="text-align: center; color: #754cbc; font-size: 1.25em"}
Part of the basic association between education and income is due to the fact that they are both affected by parental wealth.
:::
:::
  
::::

## Why multivariate regression?

<br>

::: {style="font-size: 1.75em;"}
* [Purpose 1: building the case for causality]{.fragment .semi-fade-out fragment-index=1 style="color: #e93cac"}
    * [Control for alternate explanations for the main association]{.fragment .semi-fade-out fragment-index=1 style="font-size: 0.75em"}
* [Purpose 2: developing better predictions]{style="color: #e93cac"}
    * [Predict $Y$ as a function of multiple variables, not just $X$]{style="font-size: 0.75em"}
* [Purpose 3: explain more]{.fragment .semi-fade-out fragment-index=1 style="color: #e93cac"}
    * [Use multiple variables to explain more of the variation in $Y$]{.fragment .semi-fade-out fragment-index=1 style="font-size: 0.75em"}
:::

## Purpose 2: developing better predictions

#### [Can use the multivariate regression model to predict values of the dependent variable for any combination of values of the predictors.]{style="font-size: 1.25em; text-align: center"}

::: {style="font-size:1.25em"}
$$
\widehat{Income} = 799.22 + 623.35(educ) + 0.31(\text{par_wealth})
$$
:::

::: {.fragment style="background: #e93cac; border: 4px solid #690c48; border-radius: 15px; padding: 5px 5px 5px 5px;"}
Example: What is the predicted level of income for a person with 14 years of education and whose parents have total wealth of $250,000?
:::

::: {.fragment}
$$
\begin{aligned}
\widehat{Income} &= 799.22 + 623.35(\color{#e93cac}{14}) + 0.31(\color{#e93cac}{250000}) \\
&= \$87,025.12
\end{aligned}
$$
:::

::: {.fragment style="background: #2ad2c9; border: 4px solid #1b8883; border-radius: 15px; padding: 5px 5px 5px 5px;"}
Example: What is the predicted level of income for a person with 16 years of education and whose parents have total wealth of $50,000?
:::

::: {.fragment}
$$
\begin{aligned}
\widehat{Income} &= 799.22 + 623.35(\color{#1b8883}{16}) + 0.31(\color{#1b8883}{50000}) \\
&= \$26,271.82
\end{aligned}
$$
:::

## Why multivariate regression?

<br>

::: {style="font-size: 1.75em;"}
* [Purpose 1: building the case for causality]{.fragment .semi-fade-out fragment-index=1 style="color: #e93cac"}
    * [Control for alternate explanations for the main association]{.fragment .semi-fade-out fragment-index=1 style="font-size: 0.75em"}
* [Purpose 2: developing better predictions]{.fragment .semi-fade-out fragment-index=1 style="color: #e93cac"}
    * [Predict $Y$ as a function of multiple variables, not just $X$]{.fragment .semi-fade-out fragment-index=1 style="font-size: 0.75em"}
* [Purpose 3: explain more]{style="color: #e93cac"}
    * [Use multiple variables to explain more of the variation in $Y$]{style="font-size: 0.75em"}
:::

## Purpose 3: explain more

Multivariate regression allows for more complete explanation of the variation in the dependent variable.

::: {.fragment fragment-index=1 style="color: #1b8883; font-size: 1.5em"}
Bivariate regression model
:::

::: {style="font-size: 1.25em; color: #e8e3d3"}
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

<br>

:::: {.columns}

::: {.column width="30%"}

::: {.fragment fragment-index=1 style="color: #a68100; border: 4px solid #a68100; border-radius: 15px; padding: 2px 2px 2px 2px; font-size: 1.25em; text-align: center"}
Coefficient of determination <br> 
($R^2$)
:::

::: {style="font-size: 1.25em; color: #e8e3d3"}
$$
R_2 = 0.728
$$
:::

:::
  
::: {.column width="70%"}

::: {.fragment fragment-index=1 style="font-size: 1em"}
[**Interpretations**]{.underline}: <br>

1. [The proportional reduction of prediction error achieved by using the independent variable ($X$) in the regression equation to predict the values of the dependent variable ($Y$)]{style="color: #754cbc"}
2. [The proportion of the variance in the dependent variable ($Y$) explained by the independent variable ($X$)]{style="color: #6e8e13"}
:::

:::
  
::::

## Purpose 3: explain more

Multivariate regression allows for more complete explanation of the variation in the dependent variable.

::: {style="color: #1b8883; font-size: 1.5em"}
Bivariate regression model
:::

::: {style="font-size: 1.25em"}
$\widehat{Income} = 1816.16 + 1582.58(educ)$
:::

<br>

:::: {.columns}

::: {.column width="30%"}

::: {style="color: #a68100; border: 4px solid #a68100; border-radius: 15px; padding: 2px 2px 2px 2px; font-size: 1.25em; text-align: center"}
Coefficient of determination <br> 
($R^2$)
:::

::: {style="font-size: 1.25em"}
$$
R_2 = 0.728
$$
:::

:::
  
::: {.column width="70%"}

::: {style="font-size: 1em"}
[**Interpretations**]{.underline}: <br>

1. [We can reduce our errors by almost 73% if we take into consideration individualsâ€™ education when we predict their income (i.e., use the regression line in our predictions).]{style="color: #754cbc"}
2. [Almost 73% of the variance in income is explained by differences in education.]{style="color: #6e8e13"}
:::


:::
  
::::

## Purpose 3: explain more

Multivariate regression allows for more complete explanation of the variation in the dependent variable.

::: {style="color: #e93cac; font-size: 1.5em"}
Multivariate regression model
:::

::: {style="font-size: 1.25em; color: #e8e3d3"}
$\widehat{Income} = 799.22 + 623.35(educ) + 0.31(\text{par_wealth})$
:::

<br>

:::: {.columns}

::: {.column width="30%"}

::: {style="color: #a68100; border: 4px solid #a68100; border-radius: 15px; padding: 2px 2px 2px 2px; font-size: 1.25em; text-align: center"}
Coefficient of **MULTIPLE** determination <br> 
($R^2$)
:::

::: {style="font-size: 1.25em; color: #e8e3d3"}
$$
R_2 = 0.813
$$
:::

:::
  
::: {.column width="70%"}

::: {style="font-size: 1em"}
[**Interpretations**]{.underline}: <br>

1. [The proportional [reduction of prediction error]{.underline} achieved by using [all]{.underline} of the predictors ($X$, $Z$, etc.) in the regression equation to predict the values of the dependent variable ($Y$)
]{style="color: #754cbc"}
2. [The proportion of the [variance]{.underline} in the dependent variable ($Y$) [explained]{.underline} by the [combination]{.underline} of all of the predictors ($X$, $Z$, etc.)
]{style="color: #6e8e13"}
:::

:::
  
::::

## Purpose 3: explain more

Multivariate regression allows for more complete explanation of the variation in the dependent variable.

::: {style="color: #e93cac; font-size: 1.5em"}
Multivariate regression model
:::

::: {style="font-size: 1.25em"}
$\widehat{Income} = 799.22 + 623.35(educ) + 0.31(\text{par_wealth})$
:::

<br>

:::: {.columns}

::: {.column width="30%"}

::: {style="color: #a68100; border: 4px solid #a68100; border-radius: 15px; padding: 2px 2px 2px 2px; font-size: 1.25em; text-align: center"}
Coefficient of **MULTIPLE** determination <br> 
($R^2$)
:::

::: {style="font-size: 1.25em"}
$$
R_2 = 0.813
$$
:::

:::
  
::: {.column width="70%"}

::: {style="font-size: 1em"}
[**Interpretations**]{.underline}: <br>

1. [We can reduce our errors by about 81% if we take into consideration individualsâ€™ [education and the wealth of their parents]{.underline} when we predict their income (i.e., use the regression line in our predictions).]{style="color: #754cbc"}
2. [About 81% of the variance in income is explained by the [combination]{.underline} of education and parental wealth.]{style="color: #6e8e13"}
:::


:::
  
::::

# Break! {.section-title background-color="#2ad2c9"}



## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income <- data.frame(model1 = c("1582.58", "", "1816.16", "0.73"), 
                          stars1 = c("***", "", "", ""), 
                          model2 = c("623.35", "0.31", "799.22", "0.81"),
                          stars2 = c("*", "**", "", ""))
rownames(educ_income) <- c("Education", "Parental wealth", "Constant", "Model $R^2$")


educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("N = 12 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), 
            locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = c(model2, stars2))))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("<span style='background-color: #aadb1e'> N = 12 </span> <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), 
            locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = c(model2, stars2))))  |> 
  tab_style(style = list(cell_fill(color = "#aadb1e")), 
            locations = list(cells_title()))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 100px; right: 100px; text-align: center; font-size: 1em; width: 350px"}
Title indicating the dependent variable, units of analysis. 
:::

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; bottom: 150px; left: -50px; text-align: center; font-size: 1em; width: 350px"}
Number of cases 
:::

## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("N = 12 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), 
            locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = c(model2, stars2))))  |> 
  tab_style(style = list(cell_text(color = "#1b8883")), locations = list(cells_body(rows = "Education", column = model1)))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

::: {style="background: #2ad2c9; border: 4px solid #1b8883; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 100px; right: 0px; text-align: center; font-size: 1em;"}
Slope coefficient for effect of<br>education on income.
:::

## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("N = 12 <br> <span style='color: #e93cac'> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001 </span>")) |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), 
            locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = c(model2, stars2))))  |> 
  tab_style(style = list(cell_text(color = "#1b8883")), locations = list(cells_body(rows = "Education", column = model1)))  |> 
  tab_style(style = list(cell_text(color = "#e93cac")), locations = list(cells_body(rows = "Education", column = stars1)))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

::: {style="background: #2ad2c9; border: 4px solid #1b8883; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 100px; right: 0px; text-align: center; font-size: 1em;"}
Slope coefficient for effect of<br>education on income.
:::

::: {style="color: #e93cac; position: absolute; top: 225px; right: -75px; text-align: center; font-size: 1em;"}
Statistical significance of the slope coefficient
:::

::: {.fragment .incremental style="border: 4px solid #e93cac; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 275px; right: -50px; text-align: center; font-size: 1em;; width: 450px"}
* Testing the null hypothesis ($H_0$) that $\beta = 0$ *(that the slope is zero in the population)*
* Number of stars indicates p-value for coefficient (probability of observing the sample coefficient if $H_0$ where true). 
* Reject $H_0$ if p-value < alpha
* Given [***]{style="color: #e93cac"}, our model rejects $H_0$ with $99.9\%$ confidence (alpha of $0.001$)
:::

## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("N = 12 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001 </span>")) |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), 
            locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = c(model2, stars2))))  |> 
  tab_style(style = list(cell_text(color = "#1b8883")), locations = list(cells_body(rows = "Education", column = model1)))  |>
  tab_style(style = list(cell_text(color = "#754cbc")), locations = list(cells_body(rows = "Constant", column = model1)))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

::: {style="background: #2ad2c9; border: 4px solid #1b8883; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 100px; right: 0px; text-align: center; font-size: 1em;"}
Slope coefficient for effect of<br>education on income.
:::

::: {style="background: #c5b4e3; border: 4px solid #754cbc; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 275px; right: 10px; text-align: center; font-size: 1em;"}
Y-intercept (a.k.a, constant)
:::

::: {.fragment style="border: 4px solid black; border-radius: 15px; padding: 0px 10px 0px 10px; position: absolute; bottom: 50px; left: 0px; text-align: center; font-size: 1.25em;"}
$$
\widehat{Income} = 1816.16 + 1582.58(educ)
$$
:::

## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("N = 12 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001 </span>")) |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), 
            locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = c(model2, stars2))))  |> 
  tab_style(style = list(cell_text(color = "#1b8883")), locations = list(cells_body(rows = "Education", column = model1)))  |>
  tab_style(style = list(cell_text(color = "#754cbc")), locations = list(cells_body(rows = "Constant", column = model1)))  |> 
    tab_style(style = list(cell_text(color = "#a68100")), locations = list(cells_body(rows = "Model $R^2$", column = model1)))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

::: {style="background: #2ad2c9; border: 4px solid #1b8883; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 100px; right: 0px; text-align: center; font-size: 1em;"}
Slope coefficient for effect of<br>education on income.
:::

::: {style="background: #c5b4e3; border: 4px solid #754cbc; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 275px; right: 10px; text-align: center; font-size: 1em;"}
Y-intercept (a.k.a, constant)
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 10px 0px 10px; position: absolute; bottom: 50px; left: 0px; text-align: center; font-size: 1.25em;"}
$$
\widehat{Income} = 1816.16 + 1582.58(educ)
$$
:::

::: {style="background: #ffc700; border: 4px solid #a68100; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 375px; right: 0px; text-align: center; font-size: 1em;"}
Coefficient of determination
:::






## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("N = 12 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#1b8883")), locations = list(cells_body(rows = "Education", column = model2)))  |>
  tab_style(style = list(cell_text(color = "#6e8e13")), locations = list(cells_body(rows = "Parental wealth", column = model2)))  |>
  tab_style(style = list(cell_text(color = "#754cbc")), locations = list(cells_body(rows = "Constant", column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#a68100")), locations = list(cells_body(rows = "Model $R^2$", column = model2)))  |> 
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

::: {style="background: #2ad2c9; border: 4px solid #1b8883; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 100px; right: 0px; text-align: center; font-size: 1em;"}
**Partial** slope coefficient for<br>effect of education on income.
:::

::: {style="background: #aadb1e; border: 4px solid #6e8e13; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 225px; right: -25px; text-align: center; font-size: 1em;"}
**Partial** slope coefficient for<br>effect of parental wealth on income.
:::

::: {style="background: #c5b4e3; border: 4px solid #754cbc; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 350px; right: 10px; text-align: center; font-size: 1em;"}
Y-intercept (a.k.a, constant)
:::

::: {.fragment style="border: 4px solid black; border-radius: 15px; padding: 0px 10px 0px 10px; position: absolute; bottom: 50px; left: -75px; text-align: center; font-size: 1.25em;"}
$$
\widehat{Income} = 799.22 + 623.35(educ) + 0.31(\text{par_wealth})
$$
:::

::: {style="background: #ffc700; border: 4px solid #a68100; border-radius: 15px; padding: 5px 10px 5px 10px; position: absolute; top: 445px; right: 0px; text-align: center; font-size: 1em;"}
Coefficient of determination
:::

## Regression tables

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

educ_income |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting annual income ($s)"), subtitle = "Individual-level data") |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("Education", "Parental wealth")) |> 
  tab_source_note(html("N = 12 <br> <span style='color: #e93cac'> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001 </span>")) |> 
  tab_style(style = list(cell_text(color = "#e93cac")), locations = list(cells_body(rows = c("Education", "Parental wealth"), column = stars2)))  |> 
  
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("Education", "Parental wealth"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="color: white; background: black; border: 4px solid black; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 0px; right: 0px; text-align: center; font-size: 1.25em"}
Same results in table form
:::

::: {style="color: #e93cac; position: absolute; top: 100px; right: -80px; text-align: center; font-size: 1em;"}
Statistical significance of the slope coefficients
:::

::: {.fragment style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 150px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
* Testing the null hypothesis ($H_0$) that $\beta = 0$ *(that the slope is zero in the population)*
* Number of stars indicates p-value for coefficient (probability of observing the sample coefficient if $H_0$ where true). 
* Reject $H_0$ if p-value < alpha
* Given [*]{style="color: #e93cac"} for the partial slope coefficient of education, our multivariate model rejects $H_0$ with $95\%$ confidence (alpha of $0.05$)
* Given [**]{style="color: #e93cac"} for the partial slope coefficient of parental wealth, our multivariate model rejects $H_0$ with $99\%$ confidence (alpha of $0.01$)
:::

## Practice

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty <- data.frame(model1 = c("0.327", "", "61.284", "0.015"), 
                          stars1 = c("***", "", "***", ""), 
                          model2 = c("-0.247", "2.095", "48.216", "0.071"),
                          stars2 = c("***", "***", "***", ""))
rownames(minority_poverty) <- c("% Minority", "% Poverty", "Constant", "Model $R^2$")

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {.fragment style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 150px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
1. According to the results in Model 1, is the level of crime in the neighborhood associated with the concentration of minorities in the area?  Make sure to touch on the direction, magnitude, and statistical significance of the association.
2. How much of the variation in crime rates across neighborhoods can be explained by the racial composition of the neighborhood alone?
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#e93cac")), locations = list(cells_body(column = c(model1, stars1), 
                                                                                    rows = "% Minority")))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 0px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
1. According to the results in Model 1, is the level of crime in the neighborhood associated with the concentration of minorities in the area?  Make sure to touch on the direction, magnitude, and statistical significance of the association.
:::

::: {.fragment .incremental style="border: 4px solid #e93cac; border-radius: 15px; padding: 5px 5px 5px 5px; position: absolute; top: 250px; right: -75px; font-size: 0.95em;; width: 500px"}
* **Direction**: positive slope coefficient <br> = positive association <br>
* **Magnitude**: A difference of one percentage point in the concentration of minorities is associated with an increase of 0.327 crimes per 100,000 <br>
* **Statistical significance**: Coefficient is statistically significant even if we use alpha of $0.001$. Therefore, the association in the sample is large enough to convince us that the association likely exists in the population of neighborhoods.
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#e93cac")), 
            locations = list(cells_body(column = c(model1, stars1), rows = "Model $R^2$")))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 0px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
2. How much of the variation in crime rates across neighborhoods can be explained by the racial composition of the neighborhood alone?
:::

::: {.fragment .incremental style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 300px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
Coefficient of determination indicates that about $1.5\%$ of the variation in crime rates can be explained by the racial composition.
:::

## Practice

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 0px; right: -75px; text-align: center; font-size: 0.95em;; width: 500px"}
3. According to the results in Model 2, how do the local poverty rate and concentration of minorities in the neighborhood affect local crime rates?  Make sure to touch on the direction, magnitude, and statistical significance of the effects.
4. How would you explain the dramatic change in the slope coefficient for % Minority from Model 1 to Model 2?  What does this change in coefficients imply about the causal effect of %Minority on crime rates?
5. What is the predicted level of crime in a neighborhood in which 30% of the residents are poor and 60% are members of minority groups?  How does this compare to the predicted crime rate in a neighborhood in which 30% of residents are poor and none are members of minority groups?
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#e93cac")), 
            locations = list(cells_body(column = c(model2, stars2), rows = "% Minority")))  |> 
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 0px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
3. According to the results in Model 2, how do the local poverty rate and concentration of minorities in the neighborhood affect local crime rates?  Make sure to touch on the direction, magnitude, and statistical significance of the effects.
:::

::: {.fragment style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 290px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
Controlling for % poverty, a one-unit increase in the local % minority is associated with an [*decrease*]{.underline} in crime of [$0.247$ crimes per 100,000]{.underline}, and this effect is strong enough to convince us that there is an association in the population.
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
  tab_style(style = list(cell_text(color = "#e93cac")), 
            locations = list(cells_body(column = c(model2, stars2), rows = "% Poverty")))  |> 
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 0px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
3. According to the results in Model 2, how do the local poverty rate and concentration of minorities in the neighborhood affect local crime rates?  Make sure to touch on the direction, magnitude, and statistical significance of the effects.
:::

::: {style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 290px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
Controlling for % minority, a one-unit increase in the local poverty rate is associated with an [*increase*]{.underline} in crime of [$2.095$ crimes per 100,000]{.underline}, and this effect is strong enough to convince us that there is an association in the population.
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
    tab_style(style = list(cell_text(color = "#e93cac")), 
            locations = list(cells_body(rows = "% Minority")))  |>
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 0px; right: -75px; text-align: center; font-size: 0.95em;; width: 500px"}
4. How would you explain the dramatic change in the slope coefficient for % Minority from Model 1 to Model 2?  What does this change in coefficients imply about the causal effect of % Minority on crime rates?
:::

::: {.fragment style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 250px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
Indicates that the positive association between % Minority and crime observed in Model 1 was not causal; it is actually due to the higher level of poverty in minority neighborhoods. Accounting for the poverty rate shows that higher minority concentrations are actually associated<br>with lower crime.
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
    tab_style(style = list(cell_text(color = "#e93cac")), 
            locations = list(cells_body(rows = c("% Minority", "% Poverty", "Constant"), 
                                        columns = model2)))  |>
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 0px; right: -75px; text-align: center; font-size: 0.95em;; width: 500px"}
5. What is the predicted level of crime in a neighborhood in which 30% of the residents are poor and 60% are members of minority groups?  How does this compare to the predicted crime rate in a neighborhood in which 30% of residents are poor and none are members of minority groups?
:::

::: {.fragment .incremental style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; bottom: 0px; left: -75px; text-align: center; font-size: 1em;; width: 700px"}
* $\widehat{crime} = 48.216 - 0.247(\text{% Minority}) + 2.095(\text{% Poverty})$
* [30% poverty, 60% minority]{.underline}: $\widehat{crime} = 48.216 - 0.247(60) + 2.095(30) = 96.246$
* [30% poverty, 0% minority]{.underline}: $\widehat{crime} = 48.216 - 0.247(0) + 2.095(30) = 111.066$
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
    tab_style(style = list(cell_text(color = "#e93cac")), 
            locations = list(cells_body(rows = "Constant", 
                                        columns = model2)))  |>
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 250px; right: -75px; text-align: center; font-size: 0.95em;; width: 500px"}
**BONUS**: What's the interpretation for our Y-intercept?
:::

::: {.fragment style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; bottom: 175px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
A neighborhood in which $\text{% Minority} = 0$ and $\text{% Poverty} = 0$ is predicted to have a crime rate of $48.216$ crimes per 100,000 population.
:::

## Practice 

::: {style="position: absolute; left: -75px; width: 640px"}
```{r}
#| echo: false

minority_poverty |> 
  gt(rownames_to_stub = T) |> # add rownames to column
  tab_header(title = html("Results of OLS regression models predicting crimes per 100,000 population in U.S. neighborhoods")) |> # add title and subtitle
  fmt_markdown(columns = c(1, 2, 4)) |> # include html 
  cols_align(align = "right", columns = c(model1, model2)) |> # center columns
  cols_align(align = "left", columns = c(stars1, stars2)) |> # center columns
  cols_label(model1 = "Model 1", model2 = "Model 2") |> 
  tab_row_group(label = "Predictor", rows = c("% Minority", "% Poverty")) |> 
  tab_source_note(html("N =  6,935 <br> * p < 0.05 &emsp; ** p < 0.01 &emsp; *** p < 0.001")) |> 
    tab_style(style = list(cell_text(color = "#e93cac")), 
            locations = list(cells_body(rows = "Model $R^2$", 
                                        columns = model2)))  |>
  #tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, model2, stars2)), cells_body(column = model2)))  |> 
  tab_style(style = list(cell_text(color = "#e8e3d3")), locations = list(cells_column_labels(c(stars1, stars2))))  |> 
  tab_stub_indent(rows = c("% Minority", "% Poverty"), indent = 5) |> 
  cols_width(stub() ~ pct(30), model1 ~ pct(25), stars1 ~ pct(10), model2 ~ pct(25),  stars2 ~ pct(10)) |> 
  tab_options(table.background.color = "#e8e3d3") |> # change background color
  opt_table_outline(color = "#85754d") |> # outline table with colored border 
  tab_options(table.background.color = "#e8e3d3", table_body.hlines.color = "#85754d", table_body.vlines.color = "#85754d", table_body.border.top.color = "#85754d", table_body.border.bottom.color = "#85754d", stub.border.color = "#85754d", heading.border.bottom.color = "#85754d",  column_labels.border.bottom.color = "#85754d", table.width = pct(100), table.font.size = px(18L)) 
```
:::

::: {style="border: 4px solid black; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; top: 250px; right: -75px; text-align: center; font-size: 0.95em;; width: 500px"}
**BONUS BONUS**: What's the interpretation for our coefficient of **multiple** determination?
:::

::: {.fragment style="border: 4px solid #e93cac; border-radius: 15px; padding: 0px 5px 0px 5px; position: absolute; bottom: 175px; right: -75px; text-align: center; font-size: 1em;; width: 500px"}
Coefficient of determination indicates that about $7.1\%$ of the variation in crime rates can be explained by the racial composition and poverty combined.
:::

# Homework{.section-title background-color="#e8e3d3"}

## {data-menu-title="Homework 7" background-iframe="https://vsass.github.io/SOC221/homework/homework7.html" background-interactive=TRUE}